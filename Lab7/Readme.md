

# üîê –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ7

## **–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∑–∞—Ö–∏—Å—Ç—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó: AES-GCM + ECDSA + –°—Ç–µ–≥–∞–Ω–æ–≥—Ä–∞—Ñ—ñ—è LSB**

–ü—Ä–æ—î–∫—Ç —Ä–µ–∞–ª—ñ–∑—É—î –∫–æ–º–ø–ª–µ–∫—Å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ –∑–∞—Ö–∏—Å—Ç—É –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω–∏—Ö –¥–∞–Ω–∏—Ö —à–ª—è—Ö–æ–º –ø–æ—î–¥–Ω–∞–Ω–Ω—è —Ç—Ä—å–æ—Ö –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π:

* **–°–∏–º–µ—Ç—Ä–∏—á–Ω–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è AES-256-GCM** ‚Äì –∑–∞–±–µ–∑–ø–µ—á—É—î –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å —Ç–∞ —Ü—ñ–ª—ñ—Å–Ω—ñ—Å—Ç—å.
* **–¶–∏—Ñ—Ä–æ–≤–∏–π –ø—ñ–¥–ø–∏—Å ECDSA (P-256)** ‚Äì –≥–∞—Ä–∞–Ω—Ç—É—î –∞–≤—Ç–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å —Ç–∞ –Ω–µ–º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø—ñ–¥—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö.
* **–°—Ç–µ–≥–∞–Ω–æ–≥—Ä–∞—Ñ—ñ—è LSB** ‚Äì –ø—Ä–∏—Ö–æ–≤—É—î –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ PNG –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è.

–°–∏—Å—Ç–µ–º–∞ –≤–º—ñ—î:
‚úîÔ∏è –ü—ñ–¥–ø–∏—Å—É–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏
‚úîÔ∏è –®–∏—Ñ—Ä—É–≤–∞—Ç–∏ —ó—Ö –ø–∞—Ä–æ–ª–µ–º
‚úîÔ∏è –ü—Ä–∏—Ö–æ–≤—É–≤–∞—Ç–∏ —É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ
‚úîÔ∏è –í–∏—Ç—è–≥—É–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
‚úîÔ∏è –†–æ–∑—à–∏—Ñ—Ä–æ–≤—É–≤–∞—Ç–∏
‚úîÔ∏è –ü–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —Ü–∏—Ñ—Ä–æ–≤–∏–π –ø—ñ–¥–ø–∏—Å

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
Lab7/
‚îÇ
‚îú‚îÄ‚îÄ protector/
‚îÇ   ‚îú‚îÄ‚îÄ pipeline/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ encrypt.py        # AES-GCM —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è/–¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sign.py           # –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è ECDSA –∫–ª—é—á—ñ–≤, –ø—ñ–¥–ø–∏—Å, –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stego.py          # –°—Ç–µ–≥–∞–Ω–æ–≥—Ä–∞—Ñ—ñ—è LSB
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils.py          # –ö–æ–º–±—ñ–Ω–æ–≤–∞–Ω–∏–π –ø–∞–π–ø–ª–∞–π–Ω
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ views.py              # –õ–æ–≥—ñ–∫–∞ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
‚îÇ   ‚îú‚îÄ‚îÄ forms.py              # Django —Ñ–æ—Ä–º–∏
‚îÇ
‚îú‚îÄ‚îÄ keys/
‚îÇ   ‚îú‚îÄ‚îÄ ecdsa_priv.pem        # –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á
‚îÇ   ‚îú‚îÄ‚îÄ ecdsa_pub.pem         # –ü—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á
‚îÇ
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îú‚îÄ‚îÄ upload.html
‚îÇ   ‚îú‚îÄ‚îÄ result.html
‚îÇ
‚îî‚îÄ‚îÄ README.md
```

---

## ‚öôÔ∏è –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π

```bash
git clone <repo-url>
cd Lab7
```

### 2. –°—Ç–≤–æ—Ä–∏—Ç–∏ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ

```bash
python -m venv venv
source venv/bin/activate   # Linux/Mac
venv\Scripts\activate      # Windows
```

### 3. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

```bash
pip install -r requirements.txt
```

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä

```bash
python manage.py runserver
```

---

## üîë –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤ ECDSA

–ö–ª—é—á—ñ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–æ–º–∞–Ω–¥–æ—é:

```python
python manage.py shell
>>> from protector.pipeline.sign import generate_keys
>>> generate_keys()
```

–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ —É –ø–∞–ø—Ü—ñ `keys/` –±—É–¥—É—Ç—å —Å—Ç–≤–æ—Ä–µ–Ω—ñ:

* `ecdsa_priv.pem`
* `ecdsa_pub.pem`

---

## üß© –Ø–∫ –ø—Ä–∞—Ü—é—î —Å–∏—Å—Ç–µ–º–∞

### 1Ô∏è‚É£ **–ü—ñ–¥–ø–∏—Å ‚Üí –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è ‚Üí –°—Ç–µ–≥–∞–Ω–æ–≥—Ä–∞—Ñ—ñ—è**

–ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å:

```
–§–∞–π–ª ‚Üí –ü—ñ–¥–ø–∏—Å ECDSA ‚Üí –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è AES-GCM ‚Üí –ü–∞–∫—É–≤–∞–Ω–Ω—è ‚Üí LSB-–≤–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è —É PNG
```

–†–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, —â–æ –Ω–µ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–∑—É–∞–ª—å–Ω–æ –≤—ñ–¥ –æ—Ä–∏–≥—ñ–Ω–∞–ª—É.

### 2Ô∏è‚É£ **–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è ‚Üí –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è ‚Üí –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–ø–∏—Å—É**

```
PNG ‚Üí LSB-–µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—è ‚Üí AES-GCM –¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è ‚Üí –í–∏—Ç—è–≥–Ω–µ–Ω–Ω—è –ø—ñ–¥–ø–∏—Å—É ‚Üí –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ ECDSA
```

–°–∏—Å—Ç–µ–º–∞ –ø–æ–≤–µ—Ä—Ç–∞—î —Ñ–∞–π–ª —Ç–∞ —Å—Ç–∞—Ç—É—Å–∏:

* –ü—ñ–¥–ø–∏—Å –≤–∞–ª—ñ–¥–Ω–∏–π / –Ω–µ–≤–∞–ª—ñ–¥–Ω–∏–π
* –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–µ / –ø–æ–º–∏–ª–∫–∞

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —Ç–∞ –∑–≤—ñ—Ç–∏

–°–∏—Å—Ç–µ–º–∞ –≤–∏–º—ñ—Ä—é—î:

* —á–∞—Å –ø—ñ–¥–ø–∏—Å—É
* —á–∞—Å —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
* —á–∞—Å —Å—Ç–µ–≥–∞–Ω–æ–≥—Ä–∞—Ñ—ñ—ó
* —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É
* —Ä–æ–∑–º—ñ—Ä —à–∏—Ñ—Ä—É
* —Ä–æ–∑–º—ñ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

–¶–µ –¥–æ–∑–≤–æ–ª—è—î –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Ä—ñ–∑–Ω–∏—Ö –∫–æ–º–±—ñ–Ω–∞—Ü—ñ–π –º–µ—Ç–æ–¥—ñ–≤.

---

## üßÆ –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è (–ø–∞–π–ø–ª–∞–π–Ω)

### –ó–∞—Ö–∏—Å—Ç —Ç–∞ –≤–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è

```python
from protector.pipeline.utils import protect_file

protect_file(
    input_path="text.txt",
    container_image="cover.png",
    password="mypassword"
)
```

### –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è

```python
from protector.pipeline.utils import restore_and_verify

data, ok = restore_and_verify("stego_image.png", password="mypassword")
```

---

## üõ° –ë–µ–∑–ø–µ–∫–∞

* AES-256-GCM –∑–∞–±–µ–∑–ø–µ—á—É—î –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –∞–≤—Ç–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ —á–µ—Ä–µ–∑ —Ç–µ–≥.
* ECDSA –∑–∞–ø–æ–±—ñ–≥–∞—î –ø—ñ–¥—Ä–æ–±—Ü—ñ –¥–∞–Ω–∏—Ö.
* LSB —Ä–æ–±–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –Ω–µ–ø–æ–º—ñ—Ç–Ω–æ—é.
* –°–∏—Å—Ç–µ–º–∞ –∫—Ä–∏—Ç–∏—á–Ω–æ —á—É—Ç–ª–∏–≤–∞ –¥–æ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ–π: 1 –±–∞–π—Ç ‚Üí –ø—ñ–¥–ø–∏—Å —Å—Ç–∞—î –Ω–µ–≤–∞–ª—ñ–¥–Ω–∏–º.

---

## üßë‚Äçüíª –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏

```
cryptography
Pillow
Django
base64
os
hashlib
```

---

## üìå –í–∏—Å–Ω–æ–≤–∫–∏

–ö–æ–º–±—ñ–Ω–æ–≤–∞–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—ó —Ç–∞ —Å—Ç–µ–≥–∞–Ω–æ–≥—Ä–∞—Ñ—ñ—ó —Å—É—Ç—Ç—î–≤–æ –ø—ñ–¥–≤–∏—â—É—î –±–µ–∑–ø–µ–∫—É –¥–∞–Ω–∏—Ö. –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –æ—Ö–æ–ø–ª—é—î –≤–µ—Å—å —Ü–∏–∫–ª –∑–∞—Ö–∏—Å—Ç—É: —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è, –ø—ñ–¥–ø–∏—Å, –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è, –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É, —â–æ —Ä–æ–±–∏—Ç—å —ó—ó –ø—Ä–∞–∫—Ç–∏—á–Ω–∏–º –ø—Ä–∏–∫–ª–∞–¥–æ–º –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É –¥–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–æ—ó –±–µ–∑–ø–µ–∫–∏.
